{"/home/travis/build/npmtest/node-npmtest-msexcel-builder/test.js":"/* istanbul instrument in package npmtest_msexcel_builder */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        switch (local.modeJs) {\n        // re-init local from window.local\n        case 'browser':\n            local = local.global.utility2.objectSetDefault(\n                local.global.utility2_rollup || local.global.local,\n                local.global.utility2\n            );\n            break;\n        // re-init local from example.js\n        case 'node':\n            local = (local.global.utility2_rollup || require('utility2'))\n                .requireExampleJsFromReadme();\n            break;\n        }\n        // export local\n        local.global.local = local;\n    }());\n\n\n\n    // run shared js-env code - function\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - function\n    case 'browser':\n        break;\n\n\n\n    // run node js-env code - function\n    case 'node':\n        break;\n    }\n\n\n\n    // run shared js-env code - post-init\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - post-init\n    case 'browser':\n        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test browsers's null-case handling-behavior-behavior\n         */\n            onError(null, options);\n        };\n\n        // run tests\n        local.nop(local.modeTest &&\n            document.querySelector('#testRunButton1') &&\n            document.querySelector('#testRunButton1').click());\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApidoc's default handling-behavior-behavior\n         */\n            options = { modulePathList: module.paths };\n            local.buildApidoc(options, onError);\n        };\n\n        local.testCase_buildApp_default = local.testCase_buildApp_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApp's default handling-behavior-behavior\n         */\n            local.testCase_buildReadme_default(options, local.onErrorThrow);\n            local.testCase_buildLib_default(options, local.onErrorThrow);\n            local.testCase_buildTest_default(options, local.onErrorThrow);\n            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);\n            options = [];\n            local.buildApp(options, onError);\n        };\n\n        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||\n            function (options, onError) {\n            /*\n             * this function will test buildCustomOrg's default handling-behavior\n             */\n                options = {};\n                local.buildCustomOrg(options, onError);\n            };\n\n        local.testCase_buildLib_default = local.testCase_buildLib_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildLib's default handling-behavior\n         */\n            options = {};\n            local.buildLib(options, onError);\n        };\n\n        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildReadme's default handling-behavior-behavior\n         */\n            options = {};\n            local.buildReadme(options, onError);\n        };\n\n        local.testCase_buildTest_default = local.testCase_buildTest_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildTest's default handling-behavior\n         */\n            options = {};\n            local.buildTest(options, onError);\n        };\n\n        local.testCase_webpage_default = local.testCase_webpage_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test webpage's default handling-behavior\n         */\n            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };\n            local.browserTest(options, onError);\n        };\n\n        // run test-server\n        local.testRunServer(local);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-msexcel-builder/lib.npmtest_msexcel_builder.js":"/* istanbul instrument in package npmtest_msexcel_builder */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || local;\n        // init lib\n        local.local = local.npmtest_msexcel_builder = local;\n        // init exports\n        if (local.modeJs === 'browser') {\n            local.global.utility2_npmtest_msexcel_builder = local;\n        } else {\n            module.exports = local;\n            module.exports.__dirname = __dirname;\n            module.exports.module = module;\n        }\n    }());\n}());\n","/home/travis/build/npmtest/node-npmtest-msexcel-builder/example.js":"/*\nexample.js\n\nquickstart example\n\ninstruction\n    1. save this script as example.js\n    2. run the shell command:\n        $ npm install npmtest-msexcel-builder && PORT=8081 node example.js\n    3. play with the browser-demo on http://127.0.0.1:8081\n*/\n\n\n\n/* istanbul instrument in package npmtest_msexcel_builder */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || (local.modeJs === 'browser'\n            ? local.global.utility2_npmtest_msexcel_builder\n            : global.utility2_moduleExports);\n        // export local\n        local.global.local = local;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // post-init\n    // run browser js-env code - post-init\n    /* istanbul ignore next */\n    case 'browser':\n        local.testRunBrowser = function (event) {\n            if (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('onreset'))) {\n                // reset output\n                Array.from(\n                    document.querySelectorAll('body > .resettable')\n                ).forEach(function (element) {\n                    switch (element.tagName) {\n                    case 'INPUT':\n                    case 'TEXTAREA':\n                        element.value = '';\n                        break;\n                    default:\n                        element.textContent = '';\n                    }\n                });\n            }\n            switch (event && event.currentTarget && event.currentTarget.id) {\n            case 'testRunButton1':\n                // show tests\n                if (document.querySelector('#testReportDiv1').style.display === 'none') {\n                    document.querySelector('#testReportDiv1').style.display = 'block';\n                    document.querySelector('#testRunButton1').textContent =\n                        'hide internal test';\n                    local.modeTest = true;\n                    local.testRunDefault(local);\n                // hide tests\n                } else {\n                    document.querySelector('#testReportDiv1').style.display = 'none';\n                    document.querySelector('#testRunButton1').textContent = 'run internal test';\n                }\n                break;\n            // custom-case\n            default:\n                break;\n            }\n            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('oneval')))) {\n                // try to eval input-code\n                try {\n                    /*jslint evil: true*/\n                    eval(document.querySelector('#inputTextareaEval1').value);\n                } catch (errorCaught) {\n                    console.error(errorCaught);\n                }\n            }\n        };\n        // log stderr and stdout to #outputTextareaStdout1\n        ['error', 'log'].forEach(function (key) {\n            console[key + '_original'] = console[key];\n            console[key] = function () {\n                var element;\n                console[key + '_original'].apply(console, arguments);\n                element = document.querySelector('#outputTextareaStdout1');\n                if (!element) {\n                    return;\n                }\n                // append text to #outputTextareaStdout1\n                element.value += Array.from(arguments).map(function (arg) {\n                    return typeof arg === 'string'\n                        ? arg\n                        : JSON.stringify(arg, null, 4);\n                }).join(' ') + '\\n';\n                // scroll textarea to bottom\n                element.scrollTop = element.scrollHeight;\n            };\n        });\n        // init event-handling\n        ['change', 'click', 'keyup'].forEach(function (event) {\n            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {\n                element.addEventListener(event, local.testRunBrowser);\n            });\n        });\n        // run tests\n        local.testRunBrowser();\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        // export local\n        module.exports = local;\n        // require modules\n        local.fs = require('fs');\n        local.http = require('http');\n        local.url = require('url');\n        // init assets\n        local.assetsDict = local.assetsDict || {};\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.index.template.html'] = '\\\n<!doctype html>\\n\\\n<html lang=\"en\">\\n\\\n<head>\\n\\\n<meta charset=\"UTF-8\">\\n\\\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\\n<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n    box-sizing: false,\\n\\\n    universal-selector: false\\n\\\n*/\\n\\\n* {\\n\\\n    box-sizing: border-box;\\n\\\n}\\n\\\nbody {\\n\\\n    background: #dde;\\n\\\n    font-family: Arial, Helvetica, sans-serif;\\n\\\n    margin: 2rem;\\n\\\n}\\n\\\nbody > * {\\n\\\n    margin-bottom: 1rem;\\n\\\n}\\n\\\n.utility2FooterDiv {\\n\\\n    margin-top: 20px;\\n\\\n    text-align: center;\\n\\\n}\\n\\\n</style>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n*/\\n\\\ntextarea {\\n\\\n    font-family: monospace;\\n\\\n    height: 10rem;\\n\\\n    width: 100%;\\n\\\n}\\n\\\ntextarea[readonly] {\\n\\\n    background: #ddd;\\n\\\n}\\n\\\n</style>\\n\\\n</head>\\n\\\n<body>\\n\\\n<!-- utility2-comment\\n\\\n<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\\nutility2-comment -->\\n\\\n<h1>\\n\\\n<!-- utility2-comment\\n\\\n    <a\\n\\\n        {{#if env.npm_package_homepage}}\\n\\\n        href=\"{{env.npm_package_homepage}}\"\\n\\\n        {{/if env.npm_package_homepage}}\\n\\\n        target=\"_blank\"\\n\\\n    >\\n\\\nutility2-comment -->\\n\\\n        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\\n<!-- utility2-comment\\n\\\n    </a>\\n\\\nutility2-comment -->\\n\\\n</h1>\\n\\\n<h3>{{env.npm_package_description}}</h3>\\n\\\n<!-- utility2-comment\\n\\\n<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\\n<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\\n<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\\nutility2-comment -->\\n\\\n\\n\\\n\\n\\\n\\n\\\n<label>stderr and stdout</label>\\n\\\n<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\\n<!-- utility2-comment\\n\\\n{{#if isRollup}}\\n\\\n<script src=\"assets.app.js\"></script>\\n\\\n{{#unless isRollup}}\\n\\\nutility2-comment -->\\n\\\n<script src=\"assets.utility2.rollup.js\"></script>\\n\\\n<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\\n<script src=\"assets.npmtest_msexcel_builder.rollup.js\"></script>\\n\\\n<script src=\"assets.example.js\"></script>\\n\\\n<script src=\"assets.test.js\"></script>\\n\\\n<!-- utility2-comment\\n\\\n{{/if isRollup}}\\n\\\nutility2-comment -->\\n\\\n<div class=\"utility2FooterDiv\">\\n\\\n    [ this app was created with\\n\\\n    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\\n    ]\\n\\\n</div>\\n\\\n</body>\\n\\\n</html>\\n\\\n';\n        /* jslint-ignore-end */\n        if (local.templateRender) {\n            local.assetsDict['/'] = local.templateRender(\n                local.assetsDict['/assets.index.template.html'],\n                {\n                    env: local.objectSetDefault(local.env, {\n                        npm_package_description: 'the greatest app in the world!',\n                        npm_package_name: 'my-app',\n                        npm_package_nameAlias: 'my_app',\n                        npm_package_version: '0.0.1'\n                    })\n                }\n            );\n        } else {\n            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']\n                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {\n                    // jslint-hack\n                    String(match0);\n                    switch (match1) {\n                    case 'npm_package_description':\n                        return 'the greatest app in the world!';\n                    case 'npm_package_name':\n                        return 'my-app';\n                    case 'npm_package_nameAlias':\n                        return 'my_app';\n                    case 'npm_package_version':\n                        return '0.0.1';\n                    }\n                });\n        }\n        // run the cli\n        if (local.global.utility2_rollup || module !== require.main) {\n            break;\n        }\n        local.assetsDict['/assets.example.js'] =\n            local.assetsDict['/assets.example.js'] ||\n            local.fs.readFileSync(__filename, 'utf8');\n        // bug-workaround - long $npm_package_buildCustomOrg\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.npmtest_msexcel_builder.rollup.js'] =\n            local.assetsDict['/assets.npmtest_msexcel_builder.rollup.js'] ||\n            local.fs.readFileSync(\n                local.npmtest_msexcel_builder.__dirname + '/lib.npmtest_msexcel_builder.js',\n                'utf8'\n            ).replace((/^#!/), '//');\n        /* jslint-ignore-end */\n        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';\n        // if $npm_config_timeout_exit exists,\n        // then exit this process after $npm_config_timeout_exit ms\n        if (Number(process.env.npm_config_timeout_exit)) {\n            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));\n        }\n        // start server\n        if (local.global.utility2_serverHttp1) {\n            break;\n        }\n        process.env.PORT = process.env.PORT || '8081';\n        console.error('server starting on port ' + process.env.PORT);\n        local.http.createServer(function (request, response) {\n            request.urlParsed = local.url.parse(request.url);\n            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {\n                response.end(local.assetsDict[request.urlParsed.pathname]);\n                return;\n            }\n            response.statusCode = 404;\n            response.end();\n        }).listen(process.env.PORT);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-msexcel-builder/node_modules/msexcel-builder/lib/msexcel-builder.js":"/*\r\n  MS Excel 2007 Creater v0.0.1\r\n  Author : chuanyi.zheng@gmail.com\r\n  History: 2012/11/07 first created\r\n*/\r\nvar ContentTypes, DocPropsApp, SharedStrings, Sheet, Style, Workbook, XlRels, XlWorkbook, exec, fs, opt, path, tool, xml,\r\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\r\n\r\nfs = require('fs-extra');\r\n\r\npath = require('path');\r\n\r\nexec = require('child_process');\r\n\r\nxml = require('xmlbuilder');\r\n\r\nvar EasyZip = require('easy-zip').EasyZip;\r\n\r\nvar async = require('async');\r\n\r\nvar existsSync = fs.existsSync || path.existsSync;\r\n\r\ntool = {\r\n  i2a: function(i) {\r\n    var alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',\r\n        len = alphabet.length;\r\n\r\n        function getCellAdr(num){\r\n          var pos = num % len,\r\n              tmp = Math.floor(num/len),\r\n              pos = (pos == 0) ? len : pos,\r\n              tmp = (tmp > 0 && num % len==0) ? tmp - 1: tmp,\r\n              output = alphabet.charAt(pos - 1);\r\n\r\n          if(tmp > 0){\r\n            output = getCellAdr(tmp) + output;\r\n          };\r\n          return output;\r\n        }\r\n    return getCellAdr(i);\r\n  },\r\n  copy: function(origin, target) {\r\n    var f, files, oCur, s, tCur, _i, _len, _results;\r\n    if (existsSync(origin)) {\r\n      if (!existsSync(target)) fs.mkdirSync(target, 0755);\r\n      files = fs.readdirSync(origin);\r\n      if (files) {\r\n        _results = [];\r\n        for (_i = 0, _len = files.length; _i < _len; _i++) {\r\n          f = files[_i];\r\n          oCur = origin + '/' + f;\r\n          tCur = target + '/' + f;\r\n          s = fs.statSync(oCur);\r\n          if (s.isFile()) {\r\n            _results.push(fs.writeFileSync(tCur, fs.readFileSync(oCur, ''), ''));\r\n          } else {\r\n            if (s.isDirectory()) {\r\n              _results.push(tool.copy(oCur, tCur));\r\n            } else {\r\n              _results.push(void 0);\r\n            }\r\n          }\r\n        }\r\n        return _results;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nopt = {\r\n  tmpl_path: __dirname\r\n};\r\n\r\nContentTypes = (function() {\r\n\r\n  function ContentTypes(book) {\r\n    this.book = book;\r\n  }\r\n\r\n  ContentTypes.prototype.toxml = function() {\r\n    var i, types, _ref;\r\n    types = xml.create('Types', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    types.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/content-types');\r\n    types.ele('Override', {\r\n      PartName: '/xl/theme/theme1.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml'\r\n    });\r\n    types.ele('Override', {\r\n      PartName: '/xl/styles.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'\r\n    });\r\n    types.ele('Default', {\r\n      Extension: 'rels',\r\n      ContentType: 'application/vnd.openxmlformats-package.relationships+xml'\r\n    });\r\n    types.ele('Default', {\r\n      Extension: 'xml',\r\n      ContentType: 'application/xml'\r\n    });\r\n    types.ele('Override', {\r\n      PartName: '/xl/workbook.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'\r\n    });\r\n    types.ele('Override', {\r\n      PartName: '/docProps/app.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml'\r\n    });\r\n    for (i = 1, _ref = this.book.sheets.length; 1 <= _ref ? i <= _ref : i >= _ref; 1 <= _ref ? i++ : i--) {\r\n      types.ele('Override', {\r\n        PartName: '/xl/worksheets/sheet' + i + '.xml',\r\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'\r\n      });\r\n    }\r\n    types.ele('Override', {\r\n      PartName: '/xl/sharedStrings.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'\r\n    });\r\n    types.ele('Override', {\r\n      PartName: '/docProps/core.xml',\r\n      ContentType: 'application/vnd.openxmlformats-package.core-properties+xml'\r\n    });\r\n    return types.end();\r\n  };\r\n\r\n  return ContentTypes;\r\n\r\n})();\r\n\r\nDocPropsApp = (function() {\r\n\r\n  function DocPropsApp(book) {\r\n    this.book = book;\r\n  }\r\n\r\n  DocPropsApp.prototype.toxml = function() {\r\n    var i, props, tmp, _ref;\r\n    props = xml.create('Properties', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    props.att('xmlns', 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties');\r\n    props.att('xmlns:vt', 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');\r\n    props.ele('Application', 'Microsoft Excel');\r\n    props.ele('DocSecurity', '0');\r\n    props.ele('ScaleCrop', 'false');\r\n    tmp = props.ele('HeadingPairs').ele('vt:vector', {\r\n      size: 2,\r\n      baseType: 'variant'\r\n    });\r\n    tmp.ele('vt:variant').ele('vt:lpstr', '工作表');\r\n    tmp.ele('vt:variant').ele('vt:i4', '' + this.book.sheets.length);\r\n    tmp = props.ele('TitlesOfParts').ele('vt:vector', {\r\n      size: this.book.sheets.length,\r\n      baseType: 'lpstr'\r\n    });\r\n    for (i = 1, _ref = this.book.sheets.length; 1 <= _ref ? i <= _ref : i >= _ref; 1 <= _ref ? i++ : i--) {\r\n      tmp.ele('vt:lpstr', this.book.sheets[i - 1].name);\r\n    }\r\n    props.ele('Company');\r\n    props.ele('LinksUpToDate', 'false');\r\n    props.ele('SharedDoc', 'false');\r\n    props.ele('HyperlinksChanged', 'false');\r\n    props.ele('AppVersion', '12.0000');\r\n    return props.end();\r\n  };\r\n\r\n  return DocPropsApp;\r\n\r\n})();\r\n\r\nXlWorkbook = (function() {\r\n\r\n  function XlWorkbook(book) {\r\n    this.book = book;\r\n  }\r\n\r\n  XlWorkbook.prototype.toxml = function() {\r\n    var i, tmp, wb, _ref;\r\n    wb = xml.create('workbook', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    wb.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\r\n    wb.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\r\n    wb.ele('fileVersion ', {\r\n      appName: 'xl',\r\n      lastEdited: '4',\r\n      lowestEdited: '4',\r\n      rupBuild: '4505'\r\n    });\r\n    wb.ele('workbookPr', {\r\n      filterPrivacy: '1',\r\n      defaultThemeVersion: '124226'\r\n    });\r\n    wb.ele('bookViews').ele('workbookView ', {\r\n      xWindow: '0',\r\n      yWindow: '90',\r\n      windowWidth: '19200',\r\n      windowHeight: '11640'\r\n    });\r\n    tmp = wb.ele('sheets');\r\n    for (i = 1, _ref = this.book.sheets.length; 1 <= _ref ? i <= _ref : i >= _ref; 1 <= _ref ? i++ : i--) {\r\n      tmp.ele('sheet', {\r\n        name: this.book.sheets[i - 1].name,\r\n        sheetId: '' + i,\r\n        'r:id': 'rId' + i\r\n      });\r\n    }\r\n    wb.ele('calcPr', {\r\n      calcId: '124519'\r\n    });\r\n    return wb.end();\r\n  };\r\n\r\n  return XlWorkbook;\r\n\r\n})();\r\n\r\nXlRels = (function() {\r\n\r\n  function XlRels(book) {\r\n    this.book = book;\r\n  }\r\n\r\n  XlRels.prototype.toxml = function() {\r\n    var i, rs, _ref;\r\n    rs = xml.create('Relationships', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    rs.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');\r\n    for (i = 1, _ref = this.book.sheets.length; 1 <= _ref ? i <= _ref : i >= _ref; 1 <= _ref ? i++ : i--) {\r\n      rs.ele('Relationship', {\r\n        Id: 'rId' + i,\r\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',\r\n        Target: 'worksheets/sheet' + i + '.xml'\r\n      });\r\n    }\r\n    rs.ele('Relationship', {\r\n      Id: 'rId' + (this.book.sheets.length + 1),\r\n      Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\r\n      Target: 'theme/theme1.xml'\r\n    });\r\n    rs.ele('Relationship', {\r\n      Id: 'rId' + (this.book.sheets.length + 2),\r\n      Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\r\n      Target: 'styles.xml'\r\n    });\r\n    rs.ele('Relationship', {\r\n      Id: 'rId' + (this.book.sheets.length + 3),\r\n      Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',\r\n      Target: 'sharedStrings.xml'\r\n    });\r\n    return rs.end();\r\n  };\r\n\r\n  return XlRels;\r\n\r\n})();\r\n\r\nSharedStrings = (function() {\r\n\r\n  function SharedStrings() {\r\n    this.cache = {};\r\n    this.arr = [];\r\n  }\r\n\r\n  SharedStrings.prototype.str2id = function(s) {\r\n    var id;\r\n    id = this.cache[s];\r\n    if (id) {\r\n      return id;\r\n    } else {\r\n      this.arr.push(s);\r\n      this.cache[s] = this.arr.length;\r\n      return this.arr.length;\r\n    }\r\n  };\r\n\r\n  SharedStrings.prototype.toxml = function() {\r\n    var i, si, sst, _ref;\r\n    sst = xml.create('sst', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    sst.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\r\n    sst.att('count', '' + this.arr.length);\r\n    sst.att('uniqueCount', '' + this.arr.length);\r\n    for (i = 0, _ref = this.arr.length; 0 <= _ref ? i < _ref : i > _ref; 0 <= _ref ? i++ : i--) {\r\n      si = sst.ele('si');\r\n      si.ele('t', this.arr[i]);\r\n      si.ele('phoneticPr', {\r\n        fontId: 1,\r\n        type: 'noConversion'\r\n      });\r\n    }\r\n    return sst.end();\r\n  };\r\n\r\n  return SharedStrings;\r\n\r\n})();\r\n\r\nSheet = (function() {\r\n\r\n  function Sheet(book, name, cols, rows) {\r\n    var i, j, _ref, _ref2;\r\n    this.book = book;\r\n    this.name = name;\r\n    this.cols = cols;\r\n    this.rows = rows;\r\n    this.data = {};\r\n    for (i = 1, _ref = this.rows; 1 <= _ref ? i <= _ref : i >= _ref; 1 <= _ref ? i++ : i--) {\r\n      this.data[i] = {};\r\n      for (j = 1, _ref2 = this.cols; 1 <= _ref2 ? j <= _ref2 : j >= _ref2; 1 <= _ref2 ? j++ : j--) {\r\n        this.data[i][j] = {\r\n          v: 0\r\n        };\r\n      }\r\n    }\r\n    this.merges = [];\r\n    this.col_wd = [];\r\n    this.row_ht = {};\r\n    this.styles = {};\r\n  }\r\n\r\n  Sheet.prototype.set = function(col, row, str) {\r\n    if ((str != null) && str !== '') {\r\n      return this.data[row][col].v = this.book.ss.str2id('' + str);\r\n    }\r\n  };\r\n\r\n  Sheet.prototype.merge = function(from_cell, to_cell) {\r\n    return this.merges.push({\r\n      from: from_cell,\r\n      to: to_cell\r\n    });\r\n  };\r\n\r\n  Sheet.prototype.width = function(col, wd) {\r\n    return this.col_wd.push({\r\n      c: col,\r\n      cw: wd\r\n    });\r\n  };\r\n\r\n  Sheet.prototype.height = function(row, ht) {\r\n    return this.row_ht[row] = ht;\r\n  };\r\n\r\n  Sheet.prototype.font = function(col, row, font_s) {\r\n    return this.styles['font_' + col + '_' + row] = this.book.st.font2id(font_s);\r\n  };\r\n\r\n  Sheet.prototype.fill = function(col, row, fill_s) {\r\n    return this.styles['fill_' + col + '_' + row] = this.book.st.fill2id(fill_s);\r\n  };\r\n\r\n  Sheet.prototype.border = function(col, row, bder_s) {\r\n    return this.styles['bder_' + col + '_' + row] = this.book.st.bder2id(bder_s);\r\n  };\r\n\r\n  Sheet.prototype.align = function(col, row, align_s) {\r\n    return this.styles['algn_' + col + '_' + row] = align_s;\r\n  };\r\n\r\n  Sheet.prototype.valign = function(col, row, valign_s) {\r\n    return this.styles['valgn_' + col + '_' + row] = valign_s;\r\n  };\r\n\r\n  Sheet.prototype.rotate = function(col, row, textRotation) {\r\n    return this.styles['rotate_' + col + '_' + row] = textRotation;\r\n  };\r\n\r\n  Sheet.prototype.wrap = function(col, row, wrap_s) {\r\n    return this.styles['wrap_' + col + '_' + row] = wrap_s;\r\n  };\r\n\r\n  Sheet.prototype.style_id = function(col, row) {\r\n    var id, inx, style;\r\n    inx = '_' + col + '_' + row;\r\n    style = {\r\n      font_id: this.styles['font' + inx],\r\n      fill_id: this.styles['fill' + inx],\r\n      bder_id: this.styles['bder' + inx],\r\n      align: this.styles['algn' + inx],\r\n      valign: this.styles['valgn' + inx],\r\n      rotate: this.styles['rotate' + inx],\r\n      wrap: this.styles['wrap' + inx]\r\n    };\r\n    id = this.book.st.style2id(style);\r\n    return id;\r\n  };\r\n\r\n  Sheet.prototype.toxml = function() {\r\n    var c, cols, cw, ht, i, ix, j, m, mc, r, sd, sid, ws, _i, _j, _len, _len2, _ref, _ref2, _ref3, _ref4;\r\n    ws = xml.create('worksheet', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    ws.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\r\n    ws.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\r\n    ws.ele('dimension', {\r\n      ref: 'A1'\r\n    });\r\n    ws.ele('sheetViews').ele('sheetView', {\r\n      workbookViewId: '0'\r\n    });\r\n    ws.ele('sheetFormatPr', {\r\n      defaultRowHeight: '13.5'\r\n    });\r\n    if (this.col_wd.length > 0) {\r\n      cols = ws.ele('cols');\r\n      _ref = this.col_wd;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        cw = _ref[_i];\r\n        cols.ele('col', {\r\n          min: '' + cw.c,\r\n          max: '' + cw.c,\r\n          width: cw.cw,\r\n          customWidth: '1'\r\n        });\r\n      }\r\n    }\r\n    sd = ws.ele('sheetData');\r\n    for (i = 1, _ref2 = this.rows; 1 <= _ref2 ? i <= _ref2 : i >= _ref2; 1 <= _ref2 ? i++ : i--) {\r\n      r = sd.ele('row', {\r\n        r: '' + i,\r\n        spans: '1:' + this.cols\r\n      });\r\n      ht = this.row_ht[i];\r\n      if (ht) {\r\n        r.att('ht', ht);\r\n        r.att('customHeight', '1');\r\n      }\r\n      for (j = 1, _ref3 = this.cols; 1 <= _ref3 ? j <= _ref3 : j >= _ref3; 1 <= _ref3 ? j++ : j--) {\r\n        ix = this.data[i][j];\r\n        sid = this.style_id(j, i);\r\n        if ((ix.v !== 0) || (sid !== 1)) {\r\n          c = r.ele('c', {\r\n            r: '' + tool.i2a(j) + i\r\n          });\r\n          if (sid !== 1) c.att('s', '' + (sid - 1));\r\n          if (ix.v !== 0) {\r\n            c.att('t', 's');\r\n            c.ele('v', '' + (ix.v - 1));\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (this.merges.length > 0) {\r\n      mc = ws.ele('mergeCells', {\r\n        count: this.merges.length\r\n      });\r\n      _ref4 = this.merges;\r\n      for (_j = 0, _len2 = _ref4.length; _j < _len2; _j++) {\r\n        m = _ref4[_j];\r\n        mc.ele('mergeCell', {\r\n          ref: '' + tool.i2a(m.from.col) + m.from.row + ':' + tool.i2a(m.to.col) + m.to.row\r\n        });\r\n      }\r\n    }\r\n    ws.ele('phoneticPr', {\r\n      fontId: '1',\r\n      type: 'noConversion'\r\n    });\r\n    ws.ele('pageMargins', {\r\n      left: '0.7',\r\n      right: '0.7',\r\n      top: '0.75',\r\n      bottom: '0.75',\r\n      header: '0.3',\r\n      footer: '0.3'\r\n    });\r\n    ws.ele('pageSetup', {\r\n      paperSize: '9',\r\n      orientation: 'portrait',\r\n      horizontalDpi: '200',\r\n      verticalDpi: '200'\r\n    });\r\n    return ws.end();\r\n  };\r\n\r\n  return Sheet;\r\n\r\n})();\r\n\r\nStyle = (function() {\r\n\r\n  function Style(book) {\r\n    this.book = book;\r\n    this.cache = {};\r\n    this.mfonts = [];\r\n    this.mfills = [];\r\n    this.mbders = [];\r\n    this.mstyle = [];\r\n    this.with_default();\r\n  }\r\n\r\n  Style.prototype.with_default = function() {\r\n    this.def_font_id = this.font2id(null);\r\n    this.def_fill_id = this.fill2id(null);\r\n    this.def_bder_id = this.bder2id(null);\r\n    this.def_align = '-';\r\n    this.def_valign = '-';\r\n    this.def_rotate = '-';\r\n    this.def_wrap = '-';\r\n    return this.def_style_id = this.style2id({\r\n      font_id: this.def_font_id,\r\n      fill_id: this.def_fill_id,\r\n      bder_id: this.def_bder_id,\r\n      align: this.def_align,\r\n      valign: this.def_valign,\r\n      rotate: this.def_rotate\r\n    });\r\n  };\r\n\r\n  Style.prototype.font2id = function(font) {\r\n    var id, k;\r\n    font || (font = {});\r\n    font.bold || (font.bold = '-');\r\n    font.iter || (font.iter = '-');\r\n    font.sz || (font.sz = '11');\r\n    font.color || (font.color = '-');\r\n    font.name || (font.name = '宋体');\r\n    font.scheme || (font.scheme = 'minor');\r\n    font.family || (font.family = '2');\r\n    k = 'font_' + font.bold + font.iter + font.sz + font.color + font.name + font.scheme + font.family;\r\n    id = this.cache[k];\r\n    if (id) {\r\n      return id;\r\n    } else {\r\n      this.mfonts.push(font);\r\n      this.cache[k] = this.mfonts.length;\r\n      return this.mfonts.length;\r\n    }\r\n  };\r\n\r\n  Style.prototype.fill2id = function(fill) {\r\n    var id, k;\r\n    fill || (fill = {});\r\n    fill.type || (fill.type = 'none');\r\n    fill.bgColor || (fill.bgColor = '-');\r\n    fill.fgColor || (fill.fgColor = '-');\r\n    k = 'fill_' + fill.type + fill.bgColor + fill.fgColor;\r\n    id = this.cache[k];\r\n    if (id) {\r\n      return id;\r\n    } else {\r\n      this.mfills.push(fill);\r\n      this.cache[k] = this.mfills.length;\r\n      return this.mfills.length;\r\n    }\r\n  };\r\n\r\n  Style.prototype.bder2id = function(bder) {\r\n    var id, k;\r\n    bder || (bder = {});\r\n    bder.left || (bder.left = '-');\r\n    bder.right || (bder.right = '-');\r\n    bder.top || (bder.top = '-');\r\n    bder.bottom || (bder.bottom = '-');\r\n    k = 'bder_' + bder.left + '_' + bder.right + '_' + bder.top + '_' + bder.bottom;\r\n    id = this.cache[k];\r\n    if (id) {\r\n      return id;\r\n    } else {\r\n      this.mbders.push(bder);\r\n      this.cache[k] = this.mbders.length;\r\n      return this.mbders.length;\r\n    }\r\n  };\r\n\r\n  Style.prototype.style2id = function(style) {\r\n    var id, k;\r\n    style.align || (style.align = this.def_align);\r\n    style.valign || (style.valign = this.def_valign);\r\n    style.rotate || (style.rotate = this.def_rotate);\r\n    style.wrap || (style.wrap = this.def_wrap);\r\n    style.font_id || (style.font_id = this.def_font_id);\r\n    style.fill_id || (style.fill_id = this.def_fill_id);\r\n    style.bder_id || (style.bder_id = this.def_bder_id);\r\n    k = 's_' + style.font_id + '_' + style.fill_id + '_' + style.bder_id + '_' + style.align + '_' + style.valign + '_' + style.wrap + '_' + style.rotate;\r\n    id = this.cache[k];\r\n    if (id) {\r\n      return id;\r\n    } else {\r\n      this.mstyle.push(style);\r\n      this.cache[k] = this.mstyle.length;\r\n      return this.mstyle.length;\r\n    }\r\n  };\r\n\r\n  Style.prototype.toxml = function() {\r\n    var bders, cs, e, ea, es, fills, fonts, o, ss, _i, _j, _k, _l, _len, _len2, _len3, _len4, _ref, _ref2, _ref3, _ref4;\r\n    ss = xml.create('styleSheet', {\r\n      version: '1.0',\r\n      encoding: 'UTF-8',\r\n      standalone: true\r\n    });\r\n    ss.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\r\n    fonts = ss.ele('fonts', {\r\n      count: this.mfonts.length\r\n    });\r\n    _ref = this.mfonts;\r\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n      o = _ref[_i];\r\n      e = fonts.ele('font');\r\n      if (o.bold !== '-') e.ele('b');\r\n      if (o.iter !== '-') e.ele('i');\r\n      e.ele('sz', {\r\n        val: o.sz\r\n      });\r\n      if (o.color !== '-') {\r\n        e.ele('color', {\r\n          theme: o.color\r\n        });\r\n      }\r\n      e.ele('name', {\r\n        val: o.name\r\n      });\r\n      e.ele('family', {\r\n        val: o.family\r\n      });\r\n      e.ele('charset', {\r\n        val: '134'\r\n      });\r\n      if (o.scheme !== '-') {\r\n        e.ele('scheme', {\r\n          val: 'minor'\r\n        });\r\n      }\r\n    }\r\n    fills = ss.ele('fills', {\r\n      count: this.mfills.length\r\n    });\r\n    _ref2 = this.mfills;\r\n    for (_j = 0, _len2 = _ref2.length; _j < _len2; _j++) {\r\n      o = _ref2[_j];\r\n      e = fills.ele('fill');\r\n      es = e.ele('patternFill', {\r\n        patternType: o.type\r\n      });\r\n      if (o.fgColor !== '-') {\r\n        es.ele('fgColor', {\r\n          theme: '8',\r\n          tint: '0.79998168889431442'\r\n        });\r\n      }\r\n      if (o.bgColor !== '-') {\r\n        es.ele('bgColor', {\r\n          indexed: o.bgColor\r\n        });\r\n      }\r\n    }\r\n    bders = ss.ele('borders', {\r\n      count: this.mbders.length\r\n    });\r\n    _ref3 = this.mbders;\r\n    for (_k = 0, _len3 = _ref3.length; _k < _len3; _k++) {\r\n      o = _ref3[_k];\r\n      e = bders.ele('border');\r\n      if (o.left !== '-') {\r\n        e.ele('left', {\r\n          style: o.left\r\n        }).ele('color', {\r\n          auto: '1'\r\n        });\r\n      } else {\r\n        e.ele('left');\r\n      }\r\n      if (o.right !== '-') {\r\n        e.ele('right', {\r\n          style: o.right\r\n        }).ele('color', {\r\n          auto: '1'\r\n        });\r\n      } else {\r\n        e.ele('right');\r\n      }\r\n      if (o.top !== '-') {\r\n        e.ele('top', {\r\n          style: o.top\r\n        }).ele('color', {\r\n          auto: '1'\r\n        });\r\n      } else {\r\n        e.ele('top');\r\n      }\r\n      if (o.bottom !== '-') {\r\n        e.ele('bottom', {\r\n          style: o.bottom\r\n        }).ele('color', {\r\n          auto: '1'\r\n        });\r\n      } else {\r\n        e.ele('bottom');\r\n      }\r\n      e.ele('diagonal');\r\n    }\r\n    ss.ele('cellStyleXfs', {\r\n      count: '1'\r\n    }).ele('xf', {\r\n      numFmtId: '0',\r\n      fontId: '0',\r\n      fillId: '0',\r\n      borderId: '0'\r\n    }).ele('alignment', {\r\n      vertical: 'center'\r\n    });\r\n    cs = ss.ele('cellXfs', {\r\n      count: this.mstyle.length\r\n    });\r\n    _ref4 = this.mstyle;\r\n    for (_l = 0, _len4 = _ref4.length; _l < _len4; _l++) {\r\n      o = _ref4[_l];\r\n      e = cs.ele('xf', {\r\n        numFmtId: '0',\r\n        fontId: o.font_id - 1,\r\n        fillId: o.fill_id - 1,\r\n        borderId: o.bder_id - 1,\r\n        xfId: '0'\r\n      });\r\n      if (o.font_id !== 1) e.att('applyFont', '1');\r\n      if (o.fill_id !== 1) e.att('applyFill', '1');\r\n      if (o.bder_id !== 1) e.att('applyBorder', '1');\r\n      if (o.align !== '-' || o.valign !== '-' || o.wrap !== '-' || o.rotate !== '-') {\r\n        e.att('applyAlignment', '1');\r\n        ea = e.ele('alignment', {\r\n          textRotation: (o.rotate === '-' ? '0' : o.rotate),\r\n          horizontal: (o.align === '-' ? 'left' : o.align),\r\n          vertical: (o.valign === '-' ? 'top' : o.valign)\r\n        });\r\n        if (o.wrap !== '-') ea.att('wrapText', '1');\r\n      }\r\n    }\r\n    ss.ele('cellStyles', {\r\n      count: '1'\r\n    }).ele('cellStyle', {\r\n      name: '常规',\r\n      xfId: '0',\r\n      builtinId: '0'\r\n    });\r\n    ss.ele('dxfs', {\r\n      count: '0'\r\n    });\r\n    ss.ele('tableStyles', {\r\n      count: '0',\r\n      defaultTableStyle: 'TableStyleMedium9',\r\n      defaultPivotStyle: 'PivotStyleLight16'\r\n    });\r\n    return ss.end();\r\n  };\r\n\r\n  return Style;\r\n\r\n})();\r\n\r\nWorkbook = (function() {\r\n\r\n  function Workbook(fpath, fname) {\r\n    var target;\r\n    this.fpath = fpath;\r\n    this.fname = fname;\r\n    this.save = __bind(this.save, this);\r\n    this.id = '' + Math.floor(Math.random() * 9999999);\r\n    target = path.join(this.fpath, this.id);\r\n    if (existsSync(target)) fs.rmdirSync(target);\r\n    this.sheets = [];\r\n    this.ss = new SharedStrings();\r\n    this.ct = new ContentTypes(this);\r\n    this.da = new DocPropsApp(this);\r\n    this.wb = new XlWorkbook(this);\r\n    this.re = new XlRels(this);\r\n    this.st = new Style(this);\r\n  }\r\n\r\n  Workbook.prototype.createSheet = function(name, cols, rows) {\r\n    var sheet;\r\n    sheet = new Sheet(this, name, cols, rows);\r\n    this.sheets.push(sheet);\r\n    return sheet;\r\n  };\r\n\r\n  Workbook.prototype.save = function(cb) {\r\n    var i, target, _ref, sheetList = [];\r\n    var self = this;\r\n    target = path.join(this.fpath, this.id);\r\n\r\n    for (i = 0, _ref = this.sheets.length; 0 <= _ref ? i < _ref : i > _ref; 0 <= _ref ? i++ : i--) {\r\n      sheetList.push({name: target + '/xl/worksheets/sheet' + (i + 1) + '.xml', data: this.sheets[i].toxml()});\r\n    }\r\n\r\n    async.series([\r\n      async.apply(fs.copy, opt.tmpl_path + '/tmpl', target),\r\n      async.apply(fs.mkdir, target + '/xl/_rels'),\r\n      async.apply(fs.mkdir, target + '/xl/worksheets'),\r\n      async.apply(fs.writeFile, target + '/[Content_Types].xml', self.ct.toxml()),\r\n      async.apply(fs.writeFile, target + '/docProps/app.xml', self.da.toxml()),\r\n      async.apply(fs.writeFile, target + '/xl/workbook.xml', self.wb.toxml()),\r\n      async.apply(fs.writeFile, target + '/xl/sharedStrings.xml', self.ss.toxml()),\r\n      async.apply(fs.writeFile, target + '/xl/_rels/workbook.xml.rels', self.re.toxml()),\r\n      async.apply(fs.writeFile, target + '/xl/styles.xml', self.st.toxml()),\r\n      function(cb) {\r\n        async.forEach(sheetList, function(sheet, sheetDone) {\r\n          fs.writeFile(sheet.name, sheet.data, sheetDone);\r\n        }, function(err) {\r\n          cb(err);\r\n        });\r\n      }\r\n    ], function(err) {\r\n      if(err) {\r\n        return cb(err);\r\n      }\r\n      var zip = new EasyZip();\r\n      zip.zipFolder(target+'/.', function(){\r\n        zip.writeToFile(path.join(self.fpath, self.fname));\r\n        fs.remove(target, function() {\r\n          return cb(err, path.join(self.fpath, self.fname)); // return err, path to file\r\n        });\r\n      });\r\n    });\r\n  };\r\n\r\n  Workbook.prototype.cancel = function() {\r\n    fs.remove(path.join(this.fpath, this.id));\r\n  };\r\n\r\n  return Workbook;\r\n\r\n})();\r\n\r\nmodule.exports = {\r\n  createWorkbook: function(fpath, fname) {\r\n    return new Workbook(fpath, fname);\r\n  }\r\n};\r\n"}